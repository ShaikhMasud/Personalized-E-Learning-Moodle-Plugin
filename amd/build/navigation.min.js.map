{"version":3,"file":"navigation.min.js","sources":["../src/navigation.js"],"sourcesContent":["/**\n * Navigation helper using local ajax endpoint\n *\n * @module local_automation/navigation\n */\ndefine(['jquery', 'core/templates', 'core/config'], function($, Templates, Config) {\n    'use strict';\n\n    function bindHandlers() {\n        // Toggle modal\n        $('#nav-helper-button').on('click', function() {\n            $('#nav-helper-modal').toggleClass('hidden');\n            $('#nav-helper-input').trigger('focus');\n        });\n\n        // Live search on keyup (>= 3 chars)\n        $('#nav-helper-input').on('keyup', function() {\n            const query = $(this).val().trim();\n            if (query.length < 3) {\n                $('#nav-helper-results').empty();\n                return;\n            }\n\n            const url = Config.wwwroot + '/local/automation/ajax.php';\n\n            $.ajax({\n                url: url,\n                method: 'POST',\n                dataType: 'json',\n                data: { query: query },\n                success: function(results) {\n                    const $list = $('#nav-helper-results');\n                    $list.empty();\n                    if (!results || results.length === 0) {\n                        $list.append('<li>No matches found</li>');\n                        return;\n                    }\n                    results.forEach(function(r) {\n                        const name = $('<div/>').text(r.name).html();\n                        const url = $('<div/>').text(r.url).html();\n                        $list.append('<li><a href=\"' + url + '\">' + name + '</a></li>');\n                    });\n                },\n                error: function(xhr, status, err) {\n                    // dev-friendly logging; remove in production\n                    // eslint-disable-next-line no-console\n                    console.error('navsearch AJAX failed', status, err, xhr.responseText);\n                }\n            });\n        });\n\n        // Enter key -> go to first result\n        $('#nav-helper-input').on('keypress', function(e) {\n            if (e.key === 'Enter') {\n                e.preventDefault();\n                const $first = $('#nav-helper-results li a').first();\n                if ($first.length) {\n                    window.location.href = $first.attr('href');\n                }\n            }\n        });\n\n        // Go button -> first result\n        $('#nav-helper-search-btn').on('click', function() {\n            const $first = $('#nav-helper-results li a').first();\n            if ($first.length) {\n                window.location.href = $first.attr('href');\n            }\n        });\n    }\n\n    function init() {\n        return Templates.render('local_automation/navigation', {})\n            .then(function(html) {\n                $('body').append(html);\n                bindHandlers();   // only this is needed\n            })\n            .catch(function(e) {\n                console.error('Failed to render navigation template:', e);\n            });\n    }\n\n\n    return { init: init };\n});\n"],"names":["define","$","Templates","Config","init","render","then","html","append","on","toggleClass","trigger","query","this","val","trim","length","empty","url","wwwroot","ajax","method","dataType","data","success","results","$list","forEach","r","name","text","error","xhr","status","err","console","responseText","e","key","preventDefault","$first","first","window","location","href","attr","catch"],"mappings":"AAKAA,qCAAO,CAAC,SAAU,iBAAkB,gBAAgB,SAASC,EAAGC,UAAWC,cA8EhE,CAAEC,uBAXEF,UAAUG,OAAO,8BAA+B,IAClDC,MAAK,SAASC,MACXN,EAAE,QAAQO,OAAOD,MAhEzBN,EAAE,sBAAsBQ,GAAG,SAAS,WAChCR,EAAE,qBAAqBS,YAAY,UACnCT,EAAE,qBAAqBU,QAAQ,YAInCV,EAAE,qBAAqBQ,GAAG,SAAS,iBACzBG,MAAQX,EAAEY,MAAMC,MAAMC,UACxBH,MAAMI,OAAS,cACff,EAAE,uBAAuBgB,cAIvBC,IAAMf,OAAOgB,QAAU,6BAE7BlB,EAAEmB,KAAK,CACHF,IAAKA,IACLG,OAAQ,OACRC,SAAU,OACVC,KAAM,CAAEX,MAAOA,OACfY,QAAS,SAASC,eACRC,MAAQzB,EAAE,uBAChByB,MAAMT,QACDQ,SAA8B,IAAnBA,QAAQT,OAIxBS,QAAQE,SAAQ,SAASC,SACfC,KAAO5B,EAAE,UAAU6B,KAAKF,EAAEC,MAAMtB,OAChCW,IAAMjB,EAAE,UAAU6B,KAAKF,EAAEV,KAAKX,OACpCmB,MAAMlB,OAAO,gBAAkBU,IAAM,KAAOW,KAAO,gBANnDH,MAAMlB,OAAO,8BASrBuB,MAAO,SAASC,IAAKC,OAAQC,KAGzBC,QAAQJ,MAAM,wBAAyBE,OAAQC,IAAKF,IAAII,oBAMpEnC,EAAE,qBAAqBQ,GAAG,YAAY,SAAS4B,MAC7B,UAAVA,EAAEC,IAAiB,CACnBD,EAAEE,uBACIC,OAASvC,EAAE,4BAA4BwC,QACzCD,OAAOxB,SACP0B,OAAOC,SAASC,KAAOJ,OAAOK,KAAK,aAM/C5C,EAAE,0BAA0BQ,GAAG,SAAS,iBAC9B+B,OAASvC,EAAE,4BAA4BwC,QACzCD,OAAOxB,SACP0B,OAAOC,SAASC,KAAOJ,OAAOK,KAAK,eAWtCC,OAAM,SAAST,GACZF,QAAQJ,MAAM,wCAAyCM"}